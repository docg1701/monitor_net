# Story 1.1: Environment Preparation & Tauri Initialization

## Status
Done

## Story
**As a** Developer,
**I want** to prepare the development environment for Tauri and initialize its project structure,
**so that** I can begin integrating the Angular frontend into the new desktop framework.

## Acceptance Criteria
1. Rust toolchain and Tauri CLI are installed.
2. `npx tauri init` is successfully run, creating the `src-tauri` directory.
3. The `src-tauri` directory contains a minimal, compilable Tauri project.
4. Essential Tauri v2 plugins (if any) are identified and added to `Cargo.toml`.
#### Integration Verification
IV1: The existing `ng serve` command still functions correctly.
IV2: A simple `cargo build --target=x86_64-unknown-linux-gnu` (or appropriate host target) within `src-tauri` completes without errors.

## Tasks / Subtasks
- [x] Install Rust toolchain if not already present. (AC: 1)
  - [x] Verify `rustc --version` and `cargo --version` show installed versions.
- [x] Install Tauri CLI globally. (AC: 1)
  - [x] Verify `npx tauri --version` shows installed version.
- [x] Initialize Tauri project in the `netmonitor/` directory. (AC: 2)
  - [x] Navigate to `netmonitor/`.
  - [x] Run `npx tauri init`.
  - [x] Confirm `netmonitor/src-tauri/` directory is created.
  - [x] Confirm `netmonitor/src-tauri/Cargo.toml`, `netmonitor/src-tauri/src/main.rs`, and `netmonitor/src-tauri/tauri.conf.json` exist. (Source: `architecture/enhancement-prd-provided-impact-analysis.md`)
- [x] Ensure `src-tauri` contains a minimal, compilable Tauri project. (AC: 3)
  - [x] Execute `cd src-tauri && cargo build --target=x86_64-unknown-linux-gnu` (or appropriate host target) to confirm successful build. (AC: IV2)
- [x] Identify essential Tauri v2 plugins (if any) and add to `Cargo.toml`. (AC: 4)
  - [x] Research necessary Tauri v2 plugins for basic functionality (e.g., shell, window management if needed for initial setup).
  - [x] Add identified plugins to `src-tauri/Cargo.toml` dependencies. (Source: `architecture/enhancement-prd-provided-impact-analysis.md`)
- [x] Verify existing `ng serve` command still functions correctly after Tauri initialization. (AC: IV1)
  - [x] Run `ng serve` and access the Angular application in a browser.

## Dev Notes
**Previous Story Insights**: No previous story.

**Data Models**: No specific data models for this story. (Source: No specific guidance found in architecture docs)

**API Specifications**: No specific API specifications for this story. (Source: No specific guidance found in architecture docs)

**Component Specifications**: No specific component specifications for this story. (Source: No specific guidance found in architecture docs)

**File Locations**:
- New `src-tauri/` directory will be created inside the `netmonitor/` directory. (Source: `architecture/enhancement-prd-provided-impact-analysis.md`, `architecture/source-tree-and-module-organization.md`)
- `src-tauri/Cargo.toml`: Rust project configuration. (Source: `architecture/enhancement-prd-provided-impact-analysis.md`)
- `src-tauri/src/main.rs`: Tauri's Rust backend entry point. (Source: `architecture/enhancement-prd-provided-impact-analysis.md`)
- `src-tauri/tauri.conf.json`: Tauri's application configuration. (Source: `architecture/enhancement-prd-provided-impact-analysis.md`)
- `src-tauri/capabilities/`: Security configuration for Tauri v2 permissions. (Source: `architecture/enhancement-prd-provided-impact-analysis.md`)

**Testing Requirements**:
- `cargo build --target=x86_64-unknown-linux-gnu` (or appropriate host target) within `src-tauri` must complete without errors. (Source: `docs/prd/epic-and-story-structure.md#story-1-environment-preparation-tauri-initialization`)

**Technical Constraints**:
- Migration from Electron to Tauri, leveraging native webviews and a Rust backend. (Source: `architecture/high-level-architecture.md`)
- Focus on Tauri v2 plugin architecture. (Source: `architecture/introduction.md`, `architecture/enhancement-prd-provided-impact-analysis.md`)
- Angular frontend (`netmonitor/src/`) remains largely unchanged, its build output (`www` or `dist` folder) will be consumed by Tauri. (Source: `architecture/quick-reference-key-files-and-entry-points.md`, `architecture/source-tree-and-module-organization.md`)

**Project Structure Notes**:
- The creation of `src-tauri/` in the project root aligns with the new architecture.
- The removal of the `electron/` directory is not part of this story but is a subsequent step in the migration process.

## Testing
List Relevant Testing Standards from Architecture the Developer needs to conform to:
- Test file location: The new `src-tauri` directory should be created within the `netmonitor/` directory.
- Test standards: Ensure `ng serve` continues to function, and `cargo build` within `src-tauri` completes successfully.
- Testing frameworks and patterns to use: Standard Angular testing for `ng serve` and Rust/Tauri build validation.
- Any specific testing requirements for this story:
  - Verify existing `ng serve` command still functions correctly after Tauri initialization.
  - Execute `cd netmonitor/src-tauri && cargo build --target=x86_64-unknown-linux-gnu` (or appropriate host target) to confirm successful build.
  - Integration verification of `ng serve` and `cargo build` as per Acceptance Criteria.

## Change Log
| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 05/12/2025 | 1.0 | Initial draft for Story 1.1 | Bob (Scrum Master) |

## Dev Agent Record
### Agent Model Used
Gemini 2.5 Flash
### Debug Log References
None
### Completion Notes List
- Installed Rust toolchain (v1.91.1) and Tauri CLI (v2.x).
- Initialized Tauri project in `netmonitor/src-tauri`.
- Added essential Tauri v2 plugins: `tauri-plugin-shell` and `tauri-plugin-store`.
- Configured plugin initialization in `src-tauri/src/lib.rs` and dependencies in `src-tauri/Cargo.toml`.
- Successfully compiled the Tauri backend using `cargo build`.
- Verified `ng serve` loads the Angular application. Note: Data fetching (pinging Google) fails in a standard browser environment due to CORS, which is expected behavior until running within the Tauri/Electron context or configuring a dev proxy. The application UI loads correctly.
### File List
- netmonitor/src-tauri/Cargo.toml
- netmonitor/src-tauri/src/lib.rs
- netmonitor/src-tauri/src/main.rs
- netmonitor/src-tauri/tauri.conf.json
- netmonitor/src-tauri/capabilities/default.json
- netmonitor/src-tauri/build.rs
- netmonitor/package.json (via npm install/tauri init)

## QA Results

### Review Date: 2025-12-05

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

The Tauri initialization follows standard practices. The project structure correctly integrates with the existing Angular application. The `tauri.conf.json` is correctly pointed to `../www`.

### Refactoring Performed

None. The generated code is standard boilerplate and appropriate for this stage.

### Compliance Check

- Coding Standards: [✓] Standard Rust/Tauri conventions followed.
- Project Structure: [✓] `src-tauri` placed correctly in `netmonitor`.
- Testing Strategy: [✓] Build verification passed.
- All ACs Met: [✓]

### Improvements Checklist

- [ ] Consider adding a specific npm script for tauri dev (e.g. `npm run tauri`) if not already present, for convenience.

### Security Review

Standard Tauri security configuration is in place (`capabilities/default.json`). No specific concerns for initialization.

### Performance Considerations

Build times are within acceptable limits.

### Files Modified During Review

None.

### Gate Status

Gate: PASS → docs/qa/gates/1.1.environment-preparation-and-tauri-initialization.yml
Risk profile: Low (Initialization only)

### Recommended Status

[✓ Ready for Done]

