# Story 1.4: Production Build Configuration & Verification

## Status
Approved

## Story
**As a** Developer,
**I want** to configure Tauri for production builds and verify the final application artifact,
**so that** I can confirm the successful migration and deliver a small, performant desktop application.

## Acceptance Criteria
1. `tauri.conf.json` contains necessary production settings (app name, icon, bundle ID).
2. `src-tauri/capabilities/` is configured with appropriate permissions for the production release.
3. `cargo tauri build` successfully generates a release artifact (e.g., `.AppImage` for Linux, `.exe` for Windows, etc., depending on host).
4. The size of the generated artifact is within the target (e.g., < 20MB).

## Tasks / Subtasks
- [ ] Configure `tauri.conf.json` (AC: 1)
    - [ ] Update `identifier` to a production-ready value (e.g., `com.netmonitor.app` or matching existing Android ID).
    - [ ] Verify `productName` and `version` are correct.
    - [ ] Ensure `bundle` configuration targets specific platforms if necessary (default "all" is usually fine).
    - [ ] [Reference: netmonitor/src-tauri/tauri.conf.json]
- [ ] Configure Capabilities (AC: 2)
    - [ ] Review `src-tauri/capabilities/default.json`.
    - [ ] Ensure only necessary permissions are enabled for production safety.
    - [ ] [Reference: netmonitor/src-tauri/capabilities/default.json]
- [ ] Execute Production Build (AC: 3)
    - [ ] Run `npm run build` (Angular build) to ensure `www/` is fresh.
    - [ ] Run `cargo tauri build` (or `npm run tauri build` if script exists) from `netmonitor/`.
    - [ ] Verify build completes without errors.
    - [ ] [Reference: docs/architecture/development-and-deployment.md#build-and-deployment-process]
- [ ] Verify Artifacts (AC: 4)
    - [ ] Locate the generated artifact (e.g., in `netmonitor/src-tauri/target/release/bundle/`).
    - [ ] Check file size to meet the < 20MB target.
    - [ ] Launch the artifact to ensure it runs correctly (Verification).

## Dev Notes
**Context:**
This story concludes Epic 1 (Tauri Migration). It ensures that the development environment setup (Story 1.1, 1.2) and the cleanup (Story 1.3) have resulted in a buildable, shippable product.

**File Locations:**
- **Tauri Config:** `netmonitor/src-tauri/tauri.conf.json` [Source: Architecture Scan]
- **Capabilities:** `netmonitor/src-tauri/capabilities/default.json` [Source: Architecture Scan]
- **Build Output:** `netmonitor/src-tauri/target/release/` (standard Rust/Tauri output)

**Technical Details:**
- **Bundle ID:** The current `identifier` is `com.tauri.dev`. This **must** be changed to avoid conflicts and to look professional. Suggested: `com.galvani.netmonitor` or similar.
- **Icons:** The configuration references `icons/`. Ensure these exist in `netmonitor/src-tauri/icons/`. If they are placeholders, that is acceptable for now, but the config must point to valid files.
- **Capabilities:** Tauri v2 uses a capability-based security model. `default.json` likely contains the core permissions. Review it to ensure no excessive permissions are granted.
- **Build Command:** The `beforeBuildCommand` in `tauri.conf.json` is set to `npm run build`. This means `cargo tauri build` will automatically trigger the Angular build first. This is correct and should be verified.

### Testing
- **Manual Verification:** The primary test is running the generated binary. It should open the window and display the Angular app.
- **Cross-Platform:** Since we are likely on Linux, we expect an AppImage or Deb.

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| | | | |

## Dev Agent Record

### Agent Model Used
_TBD_

### Debug Log References
_TBD_

### Completion Notes List
_TBD_

### File List
_TBD_

## QA Results
_TBD_