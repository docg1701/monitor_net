# Story 2.1: CSS Variable Refactoring

## Status
Draft

## Story
**As a** Developer,
**I want** to refactor existing hardcoded colors into CSS variables (or ensure Ionic variables are used),
**so that** I can easily invert the color scheme for Light Mode.

## Acceptance Criteria
1. All structural colors (backgrounds, text, borders) use CSS variables.
2. A `light-theme` (or default) and `dark-theme` class structure is defined in `global.scss`.
3. The application looks identical to the current version when the Dark theme is active.

## Tasks / Subtasks
- [ ] Refactor `global.scss` for Theme Support (AC: 2)
    - [ ] Remove `@import "@ionic/angular/css/palettes/dark.always.css";`.
    - [ ] Import `@ionic/angular/css/palettes/dark.class.css` instead to allow class-based switching.
    - [ ] Define default (Light) and Dark variables in `src/theme/variables.scss` or `global.scss` following Ionic standards.
    - [ ] [Reference: netmonitor/src/global.scss]
- [ ] Refactor Chart Colors in `HomePage` (AC: 1, 3)
    - [ ] Identify hardcoded RGBA values in `lineChartData` (currently `rgba(148,159,177,1)` and `0.2` opacity).
    - [ ] Replace them with a mechanism to read from CSS variables or use a CanvasGradient/Pattern if needed, OR simply ensure they match the theme variables.
    - [ ] Note: Chart.js canvas colors are often JS-side. A common pattern is to read the computed style of a dummy element or the body to get the variable value.
    - [ ] [Reference: netmonitor/src/app/home/home.page.ts]
- [ ] Verify Dark Mode Persistence (AC: 3)
    - [ ] Ensure that adding `class="ion-palette-dark"` (or equivalent) to the body makes the app look like the current "Always Dark" version.
    - [ ] [Reference: netmonitor/src/global.scss]

## Dev Notes
**Context:**
This is the first story of Epic 2 (Theme System). Currently, the app is hardcoded to "Always Dark" via Ionic's CSS import. We need to decouple this to allow dynamic switching.

**File Locations:**
- **Global Styles:** `netmonitor/src/global.scss` [Source: Architecture Scan]
- **Theme Variables:** `netmonitor/src/theme/variables.scss` [Source: Architecture Scan]
- **Home Logic:** `netmonitor/src/app/home/home.page.ts` [Source: Architecture Scan]

**Technical Details:**
- **Ionic Dark Mode:** We are moving from `dark.always.css` to `dark.class.css`. This requires the `ion-palette-dark` class to be applied to the `body` (or `html`) to trigger dark mode.
- **Chart.js Colors:** The hardcoded color `rgba(148,159,177,1)` corresponds to a specific grey-blue. This should probably be the `--ion-color-medium` or a specific chart color variable.
- **Variable Strategy:**
    - Define `--chart-line-color` and `--chart-fill-color` in `variables.scss`.
    - In `home.page.ts`, read these variables. If necessary, create a helper to read computed styles when the theme changes (though dynamic chart updating might be Story 2.2, for now just ensuring the *structure* is there is key. But wait, if we refactor to variables, the chart needs to pick them up. Story 2.2 is "Theme Toggle". This story 2.1 is "CSS Variable Refactoring". So static refactoring is the goal, but it must work).

**Project Structure Alignment:**
- No new files expected, just modification of existing style and logic files.

**Testing Requirements:**
- **Visual Verification:** Manually verify that with the dark class applied, the app looks exactly as it did before.
- **Light Mode Check:** Verify that *without* the dark class, the app renders in a default Light mode (even if unpolished, it shouldn't be broken).

## Change Log
| Date | Version | Description | Author |
| --- | --- | --- | --- |
| 2025-12-06 | 1.0.0 | Initial Draft | Bob (Scrum Master) |
